<!DOCTYPE HTML>
<html>
	<head>
	</head>
	
	<body>
		<p>This is a fun game and the goal of the game is to match the two object by moving the left one</p>
		<p>Have a try!</p>
		<table>
			<tr>
				<td>
					<canvas id="canvas1" width=800 height=500 style="border:1px solid #d3d3d3;"></canvas>
				</td>
				<td>
					<table>
						<tr>
							<td >
								<p>x-axis</p>
								<canvas id="canvas2" width=300 height=30 ></canvas>
							</td>
						</tr>
						<tr>
							<td>
								<p>y-axis</p>
								<canvas id="canvas3" width=300 height=30 ></canvas>
							</td>
						</tr>
						<tr>
							<td>
								<p>z-axis</p>
								<canvas id="canvas4" width=300 height=30 ></canvas>
							</td>
						</tr>
						<tr>
							<td>
								<p>scale</p>
								<canvas id="canvas5" width=300 height=30 ></canvas>
							</td>
						</tr>
						<tr>
							<td>
								<p>x-translate</p>
								<canvas id="canvas6" width=300 height=30 ></canvas>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
		<a href="level2.html"> Next Level </a>
	</body>
	<script src=drawlib1.js></script>
	<script>
		const PI = 3.1415926;

		var xTheta0 = 2;
		var yTheta0 = 2;
		var zTheta0 = 2;
		var scale0 = 1.0;
		var translate0 = 0.3;

		var xTheta;
		var yTheta;
		var zTheta;
		var scale;
		var translate;

		function multiplyMatrix(m1, m2){
			var newM = [[1,0,0,0],
						[0,1,0,0],
						[0,0,1,0],
						[0,0,0,1]];
			for (var i=0; i<4; i++){
				for (var j=0; j<4; j++){
					curr = 0;
					for (var k=0; k<4; k++){
						curr += m1[i][k]*m2[k][j]
					}
					newM[i][j] = curr
				}
			}
			return newM
		}

		function Matrix(){
			this.matrix = [[1,0,0,0],
						   [0,1,0,0],
						   [0,0,1,0],
						   [0,0,0,1]];
			this.identity = function(){
				this.matrix = [[1,0,0,0],
						   	   [0,1,0,0],
						   	   [0,0,1,0],
						       [0,0,0,1]];
			}

			this.translate = function(x, y, z){
				matrix = [[1,0,0,x],
						  [0,1,0,y],
						  [0,0,1,z],
						  [0,0,0,1]];
				this.matrix = multiplyMatrix(matrix, this.matrix);
			}

			this.rotateX = function(theta){
				matrix = [[1, 0, 0, 0],
					 	  [0, Math.sin(theta), Math.cos(theta), 0],
					 	  [0, -Math.cos(theta), Math.sin(theta), 0], 
					 	  [0,0,0,1]];
				this.matrix = multiplyMatrix(matrix, this.matrix);
			}

			this.rotateY = function(theta){
				matrix = [[Math.cos(theta), 0, Math.sin(theta), 0],
					 	  [0, 1, 0, 0],
					 	  [-Math.sin(theta), 0, Math.cos(theta), 0], 
					 	  [0,0,0,1]];
				this.matrix = multiplyMatrix(matrix, this.matrix);
			}

			this.rotateZ = function(theta){
				matrix = [[Math.sin(theta), Math.cos(theta), 0, 0],
						  [-Math.cos(theta), Math.sin(theta),0, 0],
						  [0,0,1,0],
						  [0,0,0,1]];
				this.matrix = multiplyMatrix(matrix, this.matrix);
			}

			this.scale = function(x, y, z){
				matrix = [[x,0,0,0],
						  [0,y,0,0],
						  [0,0,z,0],
						  [0,0,0,1]];
				this.matrix = multiplyMatrix(matrix, this.matrix);
			}

			this.prospect = function(z){
				matrix = [[1,0,0,0],
						  [0,1,0,0],
						  [0,0,1,0],
						  [0,0,z,1]];
				this.matrix = multiplyMatrix(matrix, this.matrix);
			}

			this.transform = function(src, dst){
				dst.x = this.matrix[0][0] * src.x + this.matrix[0][1] * src.y + this.matrix[0][2] * src.z + this.matrix[0][3];
    			dst.y = this.matrix[1][0] * src.x + this.matrix[1][1] * src.y + this.matrix[1][2] * src.z + this.matrix[1][3];
    			dst.z = this.matrix[2][0] * src.x + this.matrix[2][1] * src.y + this.matrix[2][2] * src.z + this.matrix[2][3];
    			dst.w = this.matrix[3][0] * src.x + this.matrix[3][1] * src.y + this.matrix[3][2] * src.z + 1;
    			dst.x = dst.x/dst.w;
    			dst.y = dst.y/dst.w;
    			dst.z = dst.z/dst.w;
 			}


		}

		var width = 800;
		var height = 500;
		function tranx(x){
			return width/2 + x*(width/2);
		}
		function trany(y){
			return height/2 - y*(width/2);
		}

		function perspect(point, f){
			point.x = point.x*(-f)/point.z;
			point.y = point.y*(-f)/point.z;
			point.z = -f/point.z;
		}


		var canvas = initCanvas("canvas1");
		
		test = new Matrix();
		test.rotateY(3);
		console.log(test.matrix);
		



		canvas.update = function(ctx){
			var points = [];

			//the first cube
			points[0] = new Vector3(-0.5, -0.5, 0.5);
			points[1] = new Vector3(0.5, -0.5, 0.5);
			points[2] = new Vector3(0.5, 0.5, 0.5);
			points[3] = new Vector3(-0.5, 0.5, 0.5);
			points[4] = new Vector3(0,0,0);


			m = new Matrix();
			newPoint = new Vector3(0.0, 0.0, 0.0);
			//points[i].translate(0.2,0.3,0.4);
			//m.rotateX(xTheta);
			m.rotateY(yTheta);
			//m.prospect(xTheta);
			//m.rotateZ(zTheta);
			//m.translate(translate,0,0);
			//m.scale(scale, scale, scale);
			for (var i=0; i<5; i++){
				newPoint = new Vector3(0.0, 0.0, 0.0);
				m.transform(points[i], newPoint);
				points[i] = newPoint;


				// console.log(points[i].x, points[i].y);
				//translate to px
				perspect(points[i], xTheta);

				points[i].x = tranx(points[i].x);
				points[i].y = trany(points[i].y);
			}

			ctx.strokeStyle = 'red';
			ctx.beginPath();
			ctx.moveTo(points[0].x, points[0].y);
			ctx.lineTo(points[1].x, points[1].y);
			ctx.lineTo(points[2].x, points[2].y);
			ctx.lineTo(points[3].x, points[3].y);
			ctx.lineTo(points[0].x, points[0].y);


			ctx.moveTo(points[0].x, points[0].y);
			ctx.lineTo(points[4].x, points[4].y);

			ctx.moveTo(points[1].x, points[1].y);
			ctx.lineTo(points[4].x, points[4].y);

			ctx.moveTo(points[2].x, points[2].y);
			ctx.lineTo(points[4].x, points[4].y);

			ctx.moveTo(points[3].x, points[3].y);
			ctx.lineTo(points[4].x, points[4].y);
			ctx.stroke();
			//console.log("hello");

			
		}

		var canvas = initCanvas("canvas2");
		canvas.update = function(ctx){
			ctx.strokeStyle = 'red';
			ctx.beginPath();
			ctx.moveTo(0, 15);
			ctx.lineTo(300, 15);
			ctx.stroke();

			ctx.beginPath();
			ctx.arc(this.cursor.x, 15, 5, 0, 2 * Math.PI);
			xTheta = PI*this.cursor.x/300;
			//console.log(this.cursor.x);
			ctx.stroke();
			ctx.fillStyle="red";
			ctx.fill();
			
		}

		var canvas = initCanvas("canvas3");
		canvas.update = function(ctx){
			ctx.strokeStyle = 'red';
			ctx.beginPath();
			ctx.moveTo(0, 15);
			ctx.lineTo(300, 15);
			ctx.stroke();

			ctx.beginPath();
			ctx.arc(this.cursor.x, 15, 5, 0, 2 * Math.PI);
			yTheta = PI*this.cursor.x/100;
			//console.log(this.cursor.x);
			ctx.stroke();
			ctx.fillStyle="red";
			ctx.fill();	
		}

		var canvas = initCanvas("canvas4");
		canvas.update = function(ctx){
			ctx.strokeStyle = 'red';
			ctx.beginPath();
			ctx.moveTo(0, 15);
			ctx.lineTo(300, 15);
			ctx.stroke();

			ctx.beginPath();
			ctx.arc(this.cursor.x, 15, 5, 0, 2 * Math.PI);
			zTheta = PI*this.cursor.x/300;
			//console.log(this.cursor.x);
			ctx.stroke();
			ctx.fillStyle="red";
			ctx.fill();	
		}

		var canvas = initCanvas("canvas5");
		canvas.update = function(ctx){
			ctx.strokeStyle = 'red';
			ctx.beginPath();
			ctx.moveTo(0, 15);
			ctx.lineTo(300, 15);
			ctx.stroke();

			ctx.beginPath();
			ctx.arc(this.cursor.x, 15, 5, 0, 2 * Math.PI);
			scale = this.cursor.x/150 + 0.3;
			//console.log(this.cursor.x);
			ctx.stroke();
			ctx.fillStyle="red";
			ctx.fill();	
		}

		var canvas = initCanvas("canvas6");
		canvas.update = function(ctx){
			ctx.strokeStyle = 'red';
			ctx.beginPath();
			ctx.moveTo(0, 15);
			ctx.lineTo(300, 15);
			ctx.stroke();

			ctx.beginPath();
			ctx.arc(this.cursor.x, 15, 5, 0, 2 * Math.PI);
			translate = this.cursor.x/150 - 1;
			//console.log(this.cursor.x);
			ctx.stroke();
			ctx.fillStyle="red";
			ctx.fill();	
		}



	</script>

</html>
